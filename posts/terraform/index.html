<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Terraform Infrastructure as Code Cheatsheet | Xudong's Tech Notes</title><meta name=keywords content><meta name=description content='Basic Terraform Commands
Initialization and Setup


1
2
3
4
5
6
7
8


# Initialize Terraform working directory
terraform init

# Initialize and upgrade modules
terraform init -upgrade

# Initialize with specific backend
terraform init -backend-config="config.hcl"


Planning and Applying


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11


# Show execution plan
terraform plan

# Apply changes
terraform apply
terraform apply -auto-approve  # Skip approval prompt

# Destroy resources
terraform destroy
terraform destroy -target aws_instance.web  # Destroy specific resource
terraform destroy -auto-approve


Workspace Management


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11


# List workspaces
terraform workspace list

# Create workspace
terraform workspace new dev

# Switch workspace
terraform workspace select prod

# Delete workspace
terraform workspace delete dev


State Management
State Commands


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17


# Show current state
terraform show

# List resources in state
terraform state list

# Move resource within state
terraform state mv aws_instance.old aws_instance.new

# Remove resource from state
terraform state rm aws_instance.web

# Pull remote state
terraform state pull

# Push state to remote
terraform state push


Variable Management
Variable Definition


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14


# variables.tf
variable "instance_type" {
  type        = string
  default     = "t2.micro"
  description = "EC2 instance type"
}

variable "environment" {
  type = string
  validation {
    condition     = contains(["dev", "staging", "prod"], var.environment)
    error_message = "Environment must be dev, staging, or prod."
  }
}


Variable Assignment


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11


# Command line variables
terraform plan -var="instance_type=t3.micro"
terraform apply -var="environment=dev"

# From file
terraform plan -var-file=custom.tfvars
terraform apply -var-file=prod.tfvars

# Environment variables
export TF_VAR_instance_type=t2.micro    # Linux/macOS
setx TF_VAR_instance_type t2.micro      # Windows


Code Quality and Formatting


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11


# Format code
terraform fmt

# Validate configuration
terraform validate

# Show providers
terraform providers

# Clean up
terraform init -reconfigure


Module Usage
Basic Module Structure


1
2
3
4
5
6
7
8


# modules/vpc/main.tf
module "vpc" {
  source = "./modules/vpc"
  
  vpc_cidr        = var.vpc_cidr
  subnet_cidrs    = var.subnet_cidrs
  vpc_name        = var.vpc_name
}


Module Versioning


1
2
3
4
5
6


module "s3_bucket" {
  source  = "terraform-aws-modules/s3-bucket/aws"
  version = "3.7.0"
  
  bucket_name = "my-bucket"
}


Best Practices


State Management'><meta name=author content="Xudong ZHAO"><link rel=canonical href=https://www.xudongzhao.com/posts/terraform/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://www.xudongzhao.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://www.xudongzhao.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://www.xudongzhao.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://www.xudongzhao.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://www.xudongzhao.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.xudongzhao.com/posts/terraform/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://www.xudongzhao.com/posts/terraform/"><meta property="og:site_name" content="Xudong's Tech Notes"><meta property="og:title" content="Terraform Infrastructure as Code Cheatsheet"><meta property="og:description" content='Basic Terraform Commands Initialization and Setup 1 2 3 4 5 6 7 8 # Initialize Terraform working directory terraform init # Initialize and upgrade modules terraform init -upgrade # Initialize with specific backend terraform init -backend-config="config.hcl" Planning and Applying 1 2 3 4 5 6 7 8 9 10 11 # Show execution plan terraform plan # Apply changes terraform apply terraform apply -auto-approve # Skip approval prompt # Destroy resources terraform destroy terraform destroy -target aws_instance.web # Destroy specific resource terraform destroy -auto-approve Workspace Management 1 2 3 4 5 6 7 8 9 10 11 # List workspaces terraform workspace list # Create workspace terraform workspace new dev # Switch workspace terraform workspace select prod # Delete workspace terraform workspace delete dev State Management State Commands 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Show current state terraform show # List resources in state terraform state list # Move resource within state terraform state mv aws_instance.old aws_instance.new # Remove resource from state terraform state rm aws_instance.web # Pull remote state terraform state pull # Push state to remote terraform state push Variable Management Variable Definition 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # variables.tf variable "instance_type" { type = string default = "t2.micro" description = "EC2 instance type" } variable "environment" { type = string validation { condition = contains(["dev", "staging", "prod"], var.environment) error_message = "Environment must be dev, staging, or prod." } } Variable Assignment 1 2 3 4 5 6 7 8 9 10 11 # Command line variables terraform plan -var="instance_type=t3.micro" terraform apply -var="environment=dev" # From file terraform plan -var-file=custom.tfvars terraform apply -var-file=prod.tfvars # Environment variables export TF_VAR_instance_type=t2.micro # Linux/macOS setx TF_VAR_instance_type t2.micro # Windows Code Quality and Formatting 1 2 3 4 5 6 7 8 9 10 11 # Format code terraform fmt # Validate configuration terraform validate # Show providers terraform providers # Clean up terraform init -reconfigure Module Usage Basic Module Structure 1 2 3 4 5 6 7 8 # modules/vpc/main.tf module "vpc" { source = "./modules/vpc" vpc_cidr = var.vpc_cidr subnet_cidrs = var.subnet_cidrs vpc_name = var.vpc_name } Module Versioning 1 2 3 4 5 6 module "s3_bucket" { source = "terraform-aws-modules/s3-bucket/aws" version = "3.7.0" bucket_name = "my-bucket" } Best Practices State Management'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-27T08:39:57+00:00"><meta property="article:modified_time" content="2023-11-27T08:39:57+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Terraform Infrastructure as Code Cheatsheet"><meta name=twitter:description content='Basic Terraform Commands
Initialization and Setup


1
2
3
4
5
6
7
8


# Initialize Terraform working directory
terraform init

# Initialize and upgrade modules
terraform init -upgrade

# Initialize with specific backend
terraform init -backend-config="config.hcl"


Planning and Applying


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11


# Show execution plan
terraform plan

# Apply changes
terraform apply
terraform apply -auto-approve  # Skip approval prompt

# Destroy resources
terraform destroy
terraform destroy -target aws_instance.web  # Destroy specific resource
terraform destroy -auto-approve


Workspace Management


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11


# List workspaces
terraform workspace list

# Create workspace
terraform workspace new dev

# Switch workspace
terraform workspace select prod

# Delete workspace
terraform workspace delete dev


State Management
State Commands


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17


# Show current state
terraform show

# List resources in state
terraform state list

# Move resource within state
terraform state mv aws_instance.old aws_instance.new

# Remove resource from state
terraform state rm aws_instance.web

# Pull remote state
terraform state pull

# Push state to remote
terraform state push


Variable Management
Variable Definition


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14


# variables.tf
variable "instance_type" {
  type        = string
  default     = "t2.micro"
  description = "EC2 instance type"
}

variable "environment" {
  type = string
  validation {
    condition     = contains(["dev", "staging", "prod"], var.environment)
    error_message = "Environment must be dev, staging, or prod."
  }
}


Variable Assignment


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11


# Command line variables
terraform plan -var="instance_type=t3.micro"
terraform apply -var="environment=dev"

# From file
terraform plan -var-file=custom.tfvars
terraform apply -var-file=prod.tfvars

# Environment variables
export TF_VAR_instance_type=t2.micro    # Linux/macOS
setx TF_VAR_instance_type t2.micro      # Windows


Code Quality and Formatting


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11


# Format code
terraform fmt

# Validate configuration
terraform validate

# Show providers
terraform providers

# Clean up
terraform init -reconfigure


Module Usage
Basic Module Structure


1
2
3
4
5
6
7
8


# modules/vpc/main.tf
module "vpc" {
  source = "./modules/vpc"
  
  vpc_cidr        = var.vpc_cidr
  subnet_cidrs    = var.subnet_cidrs
  vpc_name        = var.vpc_name
}


Module Versioning


1
2
3
4
5
6


module "s3_bucket" {
  source  = "terraform-aws-modules/s3-bucket/aws"
  version = "3.7.0"
  
  bucket_name = "my-bucket"
}


Best Practices


State Management'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.xudongzhao.com/posts/"},{"@type":"ListItem","position":2,"name":"Terraform Infrastructure as Code Cheatsheet","item":"https://www.xudongzhao.com/posts/terraform/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Terraform Infrastructure as Code Cheatsheet","name":"Terraform Infrastructure as Code Cheatsheet","description":"Basic Terraform Commands Initialization and Setup 1 2 3 4 5 6 7 8 # Initialize Terraform working directory terraform init # Initialize and upgrade modules terraform init -upgrade # Initialize with specific backend terraform init -backend-config=\u0026#34;config.hcl\u0026#34; Planning and Applying 1 2 3 4 5 6 7 8 9 10 11 # Show execution plan terraform plan # Apply changes terraform apply terraform apply -auto-approve # Skip approval prompt # Destroy resources terraform destroy terraform destroy -target aws_instance.web # Destroy specific resource terraform destroy -auto-approve Workspace Management 1 2 3 4 5 6 7 8 9 10 11 # List workspaces terraform workspace list # Create workspace terraform workspace new dev # Switch workspace terraform workspace select prod # Delete workspace terraform workspace delete dev State Management State Commands 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Show current state terraform show # List resources in state terraform state list # Move resource within state terraform state mv aws_instance.old aws_instance.new # Remove resource from state terraform state rm aws_instance.web # Pull remote state terraform state pull # Push state to remote terraform state push Variable Management Variable Definition 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # variables.tf variable \u0026#34;instance_type\u0026#34; { type = string default = \u0026#34;t2.micro\u0026#34; description = \u0026#34;EC2 instance type\u0026#34; } variable \u0026#34;environment\u0026#34; { type = string validation { condition = contains([\u0026#34;dev\u0026#34;, \u0026#34;staging\u0026#34;, \u0026#34;prod\u0026#34;], var.environment) error_message = \u0026#34;Environment must be dev, staging, or prod.\u0026#34; } } Variable Assignment 1 2 3 4 5 6 7 8 9 10 11 # Command line variables terraform plan -var=\u0026#34;instance_type=t3.micro\u0026#34; terraform apply -var=\u0026#34;environment=dev\u0026#34; # From file terraform plan -var-file=custom.tfvars terraform apply -var-file=prod.tfvars # Environment variables export TF_VAR_instance_type=t2.micro # Linux/macOS setx TF_VAR_instance_type t2.micro # Windows Code Quality and Formatting 1 2 3 4 5 6 7 8 9 10 11 # Format code terraform fmt # Validate configuration terraform validate # Show providers terraform providers # Clean up terraform init -reconfigure Module Usage Basic Module Structure 1 2 3 4 5 6 7 8 # modules/vpc/main.tf module \u0026#34;vpc\u0026#34; { source = \u0026#34;./modules/vpc\u0026#34; vpc_cidr = var.vpc_cidr subnet_cidrs = var.subnet_cidrs vpc_name = var.vpc_name } Module Versioning 1 2 3 4 5 6 module \u0026#34;s3_bucket\u0026#34; { source = \u0026#34;terraform-aws-modules/s3-bucket/aws\u0026#34; version = \u0026#34;3.7.0\u0026#34; bucket_name = \u0026#34;my-bucket\u0026#34; } Best Practices State Management\n","keywords":[],"articleBody":"Basic Terraform Commands Initialization and Setup 1 2 3 4 5 6 7 8 # Initialize Terraform working directory terraform init # Initialize and upgrade modules terraform init -upgrade # Initialize with specific backend terraform init -backend-config=\"config.hcl\" Planning and Applying 1 2 3 4 5 6 7 8 9 10 11 # Show execution plan terraform plan # Apply changes terraform apply terraform apply -auto-approve # Skip approval prompt # Destroy resources terraform destroy terraform destroy -target aws_instance.web # Destroy specific resource terraform destroy -auto-approve Workspace Management 1 2 3 4 5 6 7 8 9 10 11 # List workspaces terraform workspace list # Create workspace terraform workspace new dev # Switch workspace terraform workspace select prod # Delete workspace terraform workspace delete dev State Management State Commands 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Show current state terraform show # List resources in state terraform state list # Move resource within state terraform state mv aws_instance.old aws_instance.new # Remove resource from state terraform state rm aws_instance.web # Pull remote state terraform state pull # Push state to remote terraform state push Variable Management Variable Definition 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # variables.tf variable \"instance_type\" { type = string default = \"t2.micro\" description = \"EC2 instance type\" } variable \"environment\" { type = string validation { condition = contains([\"dev\", \"staging\", \"prod\"], var.environment) error_message = \"Environment must be dev, staging, or prod.\" } } Variable Assignment 1 2 3 4 5 6 7 8 9 10 11 # Command line variables terraform plan -var=\"instance_type=t3.micro\" terraform apply -var=\"environment=dev\" # From file terraform plan -var-file=custom.tfvars terraform apply -var-file=prod.tfvars # Environment variables export TF_VAR_instance_type=t2.micro # Linux/macOS setx TF_VAR_instance_type t2.micro # Windows Code Quality and Formatting 1 2 3 4 5 6 7 8 9 10 11 # Format code terraform fmt # Validate configuration terraform validate # Show providers terraform providers # Clean up terraform init -reconfigure Module Usage Basic Module Structure 1 2 3 4 5 6 7 8 # modules/vpc/main.tf module \"vpc\" { source = \"./modules/vpc\" vpc_cidr = var.vpc_cidr subnet_cidrs = var.subnet_cidrs vpc_name = var.vpc_name } Module Versioning 1 2 3 4 5 6 module \"s3_bucket\" { source = \"terraform-aws-modules/s3-bucket/aws\" version = \"3.7.0\" bucket_name = \"my-bucket\" } Best Practices State Management\nUse remote state storage Enable state locking Use workspaces for environments Back up state files Code Organization\nUse consistent naming Separate environments Modularize common patterns Version control all code Security\nUse variables for sensitive data Store secrets in vault/KMS Use least privilege access Enable audit logging Resource Naming\n1 2 3 4 5 6 7 8 resource \"aws_instance\" \"web\" { tags = { Name = \"${var.project}-${var.environment}-instance\" Environment = var.environment Project = var.project Terraform = \"true\" } } Common Patterns Provider Configuration 1 2 3 4 5 6 7 8 9 10 provider \"aws\" { region = var.aws_region default_tags { tags = { Environment = var.environment Terraform = \"true\" } } } Data Sources 1 2 3 4 5 6 7 8 9 10 data \"aws_ami\" \"ubuntu\" { most_recent = true filter { name = \"name\" values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"] } owners = [\"099720109477\"] # Canonical } Output Values 1 2 3 4 5 output \"instance_ip\" { value = aws_instance.web.public_ip description = \"Public IP of the web instance\" sensitive = false } Troubleshooting Common Issues 1 2 3 4 5 6 7 8 9 10 # Clean up terraform directory rm -rf .terraform terraform init # Debug logging export TF_LOG=DEBUG export TF_LOG_PATH=terraform.log # Force unlock state terraform force-unlock LOCK_ID State Recovery 1 2 3 4 5 # Backup state terraform state pull \u003e terraform.tfstate.backup # Import existing resource terraform import aws_instance.web i-1234567890abcdef0 Development Workflow Initialize Project\n1 2 terraform init terraform workspace new dev Write Configuration\n1 2 terraform fmt terraform validate Plan Changes\n1 terraform plan -out=tfplan Apply Changes\n1 terraform apply tfplan Version Control\n1 2 3 git add . git commit -m \"Add new resources\" git push Terraform variable assignment\n","wordCount":"671","inLanguage":"en","datePublished":"2023-11-27T08:39:57Z","dateModified":"2023-11-27T08:39:57Z","author":{"@type":"Person","name":"Xudong ZHAO"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.xudongzhao.com/posts/terraform/"},"publisher":{"@type":"Organization","name":"Xudong's Tech Notes","logo":{"@type":"ImageObject","url":"https://www.xudongzhao.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.xudongzhao.com/ accesskey=h title="Xudong's Tech Notes (Alt + H)">Xudong's Tech Notes</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.xudongzhao.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://www.xudongzhao.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://www.xudongzhao.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.xudongzhao.com/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.xudongzhao.com/>Home</a>&nbsp;»&nbsp;<a href=https://www.xudongzhao.com/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Terraform Infrastructure as Code Cheatsheet</h1><div class=post-meta><span class=meta-item><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=post-date>2023-11-27</span>
</span><span class=meta-item><span class=post-word-count>&nbsp;· 671&nbsp;words</span></span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#basic-terraform-commands>Basic Terraform Commands</a><ul><li><a href=#initialization-and-setup>Initialization and Setup</a></li><li><a href=#planning-and-applying>Planning and Applying</a></li><li><a href=#workspace-management>Workspace Management</a></li></ul></li><li><a href=#state-management>State Management</a><ul><li><a href=#state-commands>State Commands</a></li></ul></li><li><a href=#variable-management>Variable Management</a><ul><li><a href=#variable-definition>Variable Definition</a></li><li><a href=#variable-assignment>Variable Assignment</a></li></ul></li><li><a href=#code-quality-and-formatting>Code Quality and Formatting</a></li><li><a href=#module-usage>Module Usage</a><ul><li><a href=#basic-module-structure>Basic Module Structure</a></li><li><a href=#module-versioning>Module Versioning</a></li></ul></li><li><a href=#best-practices>Best Practices</a></li><li><a href=#common-patterns>Common Patterns</a><ul><li><a href=#provider-configuration>Provider Configuration</a></li><li><a href=#data-sources>Data Sources</a></li><li><a href=#output-values>Output Values</a></li></ul></li><li><a href=#troubleshooting>Troubleshooting</a><ul><li><a href=#common-issues>Common Issues</a></li><li><a href=#state-recovery>State Recovery</a></li></ul></li><li><a href=#development-workflow>Development Workflow</a></li></ul></nav></div></details></div><div class=post-content><h2 id=basic-terraform-commands>Basic Terraform Commands<a hidden class=anchor aria-hidden=true href=#basic-terraform-commands>#</a></h2><h3 id=initialization-and-setup>Initialization and Setup<a hidden class=anchor aria-hidden=true href=#initialization-and-setup>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7>7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Initialize Terraform working directory</span>
</span></span><span class=line><span class=cl>terraform init
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initialize and upgrade modules</span>
</span></span><span class=line><span class=cl>terraform init -upgrade
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initialize with specific backend</span>
</span></span><span class=line><span class=cl>terraform init -backend-config<span class=o>=</span><span class=s2>&#34;config.hcl&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=planning-and-applying>Planning and Applying<a hidden class=anchor aria-hidden=true href=#planning-and-applying>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Show execution plan</span>
</span></span><span class=line><span class=cl>terraform plan
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Apply changes</span>
</span></span><span class=line><span class=cl>terraform apply
</span></span><span class=line><span class=cl>terraform apply -auto-approve  <span class=c1># Skip approval prompt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Destroy resources</span>
</span></span><span class=line><span class=cl>terraform destroy
</span></span><span class=line><span class=cl>terraform destroy -target aws_instance.web  <span class=c1># Destroy specific resource</span>
</span></span><span class=line><span class=cl>terraform destroy -auto-approve
</span></span></code></pre></td></tr></table></div></div><h3 id=workspace-management>Workspace Management<a hidden class=anchor aria-hidden=true href=#workspace-management>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># List workspaces</span>
</span></span><span class=line><span class=cl>terraform workspace list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create workspace</span>
</span></span><span class=line><span class=cl>terraform workspace new dev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Switch workspace</span>
</span></span><span class=line><span class=cl>terraform workspace <span class=k>select</span> prod
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Delete workspace</span>
</span></span><span class=line><span class=cl>terraform workspace delete dev
</span></span></code></pre></td></tr></table></div></div><h2 id=state-management>State Management<a hidden class=anchor aria-hidden=true href=#state-management>#</a></h2><h3 id=state-commands>State Commands<a hidden class=anchor aria-hidden=true href=#state-commands>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Show current state</span>
</span></span><span class=line><span class=cl>terraform show
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># List resources in state</span>
</span></span><span class=line><span class=cl>terraform state list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Move resource within state</span>
</span></span><span class=line><span class=cl>terraform state mv aws_instance.old aws_instance.new
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remove resource from state</span>
</span></span><span class=line><span class=cl>terraform state rm aws_instance.web
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Pull remote state</span>
</span></span><span class=line><span class=cl>terraform state pull
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Push state to remote</span>
</span></span><span class=line><span class=cl>terraform state push
</span></span></code></pre></td></tr></table></div></div><h2 id=variable-management>Variable Management<a hidden class=anchor aria-hidden=true href=#variable-management>#</a></h2><h3 id=variable-definition>Variable Definition<a hidden class=anchor aria-hidden=true href=#variable-definition>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=c1># variables.tf
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>variable</span> <span class=s2>&#34;instance_type&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  type</span>        <span class=o>=</span> <span class=k>string</span>
</span></span><span class=line><span class=cl><span class=n>  default</span>     <span class=o>=</span> <span class=s2>&#34;t2.micro&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  description</span> <span class=o>=</span> <span class=s2>&#34;EC2 instance type&#34;</span>
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>variable</span> <span class=s2>&#34;environment&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  type</span> <span class=o>=</span> <span class=k>string</span>
</span></span><span class=line><span class=cl>  <span class=k>validation</span> {
</span></span><span class=line><span class=cl><span class=n>    condition</span>     <span class=o>=</span> <span class=k>contains</span><span class=p>([</span><span class=s2>&#34;dev&#34;, &#34;staging&#34;, &#34;prod&#34;</span><span class=p>],</span> <span class=k>var</span><span class=p>.</span><span class=k>environment</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>    error_message</span> <span class=o>=</span> <span class=s2>&#34;Environment must be dev, staging, or prod.&#34;</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=variable-assignment>Variable Assignment<a hidden class=anchor aria-hidden=true href=#variable-assignment>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Command line variables</span>
</span></span><span class=line><span class=cl>terraform plan -var<span class=o>=</span><span class=s2>&#34;instance_type=t3.micro&#34;</span>
</span></span><span class=line><span class=cl>terraform apply -var<span class=o>=</span><span class=s2>&#34;environment=dev&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># From file</span>
</span></span><span class=line><span class=cl>terraform plan -var-file<span class=o>=</span>custom.tfvars
</span></span><span class=line><span class=cl>terraform apply -var-file<span class=o>=</span>prod.tfvars
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Environment variables</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TF_VAR_instance_type</span><span class=o>=</span>t2.micro    <span class=c1># Linux/macOS</span>
</span></span><span class=line><span class=cl>setx TF_VAR_instance_type t2.micro      <span class=c1># Windows</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=code-quality-and-formatting>Code Quality and Formatting<a hidden class=anchor aria-hidden=true href=#code-quality-and-formatting>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Format code</span>
</span></span><span class=line><span class=cl>terraform fmt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Validate configuration</span>
</span></span><span class=line><span class=cl>terraform validate
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Show providers</span>
</span></span><span class=line><span class=cl>terraform providers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Clean up</span>
</span></span><span class=line><span class=cl>terraform init -reconfigure
</span></span></code></pre></td></tr></table></div></div><h2 id=module-usage>Module Usage<a hidden class=anchor aria-hidden=true href=#module-usage>#</a></h2><h3 id=basic-module-structure>Basic Module Structure<a hidden class=anchor aria-hidden=true href=#basic-module-structure>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6>6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7>7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=c1># modules/vpc/main.tf
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>module</span> <span class=s2>&#34;vpc&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  source</span> <span class=o>=</span> <span class=s2>&#34;./modules/vpc&#34;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>vpc_cidr</span>        <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>vpc_cidr</span>
</span></span><span class=line><span class=cl><span class=n>  subnet_cidrs</span>    <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>subnet_cidrs</span>
</span></span><span class=line><span class=cl><span class=n>  vpc_name</span>        <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>vpc_name</span>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=module-versioning>Module Versioning<a hidden class=anchor aria-hidden=true href=#module-versioning>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=k>module</span> <span class=s2>&#34;s3_bucket&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  source</span>  <span class=o>=</span> <span class=s2>&#34;terraform-aws-modules/s3-bucket/aws&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  version</span> <span class=o>=</span> <span class=s2>&#34;3.7.0&#34;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>bucket_name</span> <span class=o>=</span> <span class=s2>&#34;my-bucket&#34;</span>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h2 id=best-practices>Best Practices<a hidden class=anchor aria-hidden=true href=#best-practices>#</a></h2><ol><li><p><strong>State Management</strong></p><ul><li>Use remote state storage</li><li>Enable state locking</li><li>Use workspaces for environments</li><li>Back up state files</li></ul></li><li><p><strong>Code Organization</strong></p><ul><li>Use consistent naming</li><li>Separate environments</li><li>Modularize common patterns</li><li>Version control all code</li></ul></li><li><p><strong>Security</strong></p><ul><li>Use variables for sensitive data</li><li>Store secrets in vault/KMS</li><li>Use least privilege access</li><li>Enable audit logging</li></ul></li><li><p><strong>Resource Naming</strong></p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=k>resource</span> <span class=s2>&#34;aws_instance&#34; &#34;web&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  tags</span> <span class=o>=</span> {
</span></span><span class=line><span class=cl><span class=n>    Name</span>        <span class=o>=</span> <span class=s2>&#34;${var.project}-${var.environment}-instance&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    Environment</span> <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>environment</span>
</span></span><span class=line><span class=cl><span class=n>    Project</span>     <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>project</span>
</span></span><span class=line><span class=cl><span class=n>    Terraform</span>   <span class=o>=</span> <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h2 id=common-patterns>Common Patterns<a hidden class=anchor aria-hidden=true href=#common-patterns>#</a></h2><h3 id=provider-configuration>Provider Configuration<a hidden class=anchor aria-hidden=true href=#provider-configuration>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=k>provider</span> <span class=s2>&#34;aws&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  region</span> <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>aws_region</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>default_tags</span> {
</span></span><span class=line><span class=cl><span class=n>    tags</span> <span class=o>=</span> {
</span></span><span class=line><span class=cl><span class=n>      Environment</span> <span class=o>=</span> <span class=k>var</span><span class=p>.</span><span class=k>environment</span>
</span></span><span class=line><span class=cl><span class=n>      Terraform</span>   <span class=o>=</span> <span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=data-sources>Data Sources<a hidden class=anchor aria-hidden=true href=#data-sources>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=k>data</span> <span class=s2>&#34;aws_ami&#34; &#34;ubuntu&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  most_recent</span> <span class=o>=</span> <span class=kt>true</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>filter</span> {
</span></span><span class=line><span class=cl><span class=n>    name</span>   <span class=o>=</span> <span class=s2>&#34;name&#34;</span>
</span></span><span class=line><span class=cl><span class=n>    values</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>owners</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;099720109477&#34;</span><span class=p>]</span><span class=c1> # Canonical
</span></span></span><span class=line><span class=cl><span class=c1></span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=output-values>Output Values<a hidden class=anchor aria-hidden=true href=#output-values>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-hcl data-lang=hcl><span class=line><span class=cl><span class=k>output</span> <span class=s2>&#34;instance_ip&#34;</span> {
</span></span><span class=line><span class=cl><span class=n>  value</span>       <span class=o>=</span> <span class=k>aws_instance</span><span class=p>.</span><span class=k>web</span><span class=p>.</span><span class=k>public_ip</span>
</span></span><span class=line><span class=cl><span class=n>  description</span> <span class=o>=</span> <span class=s2>&#34;Public IP of the web instance&#34;</span>
</span></span><span class=line><span class=cl><span class=n>  sensitive</span>   <span class=o>=</span> <span class=kt>false</span>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h2 id=troubleshooting>Troubleshooting<a hidden class=anchor aria-hidden=true href=#troubleshooting>#</a></h2><h3 id=common-issues>Common Issues<a hidden class=anchor aria-hidden=true href=#common-issues>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Clean up terraform directory</span>
</span></span><span class=line><span class=cl>rm -rf .terraform
</span></span><span class=line><span class=cl>terraform init
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Debug logging</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TF_LOG</span><span class=o>=</span>DEBUG
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TF_LOG_PATH</span><span class=o>=</span>terraform.log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Force unlock state</span>
</span></span><span class=line><span class=cl>terraform force-unlock LOCK_ID
</span></span></code></pre></td></tr></table></div></div><h3 id=state-recovery>State Recovery<a hidden class=anchor aria-hidden=true href=#state-recovery>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Backup state</span>
</span></span><span class=line><span class=cl>terraform state pull &gt; terraform.tfstate.backup
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Import existing resource</span>
</span></span><span class=line><span class=cl>terraform import aws_instance.web i-1234567890abcdef0
</span></span></code></pre></td></tr></table></div></div><h2 id=development-workflow>Development Workflow<a hidden class=anchor aria-hidden=true href=#development-workflow>#</a></h2><ol><li><p><strong>Initialize Project</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init
</span></span><span class=line><span class=cl>terraform workspace new dev
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Write Configuration</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform fmt
</span></span><span class=line><span class=cl>terraform validate
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Plan Changes</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform plan -out<span class=o>=</span>tfplan
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Apply Changes</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply tfplan
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Version Control</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2>2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git add .
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;Add new resources&#34;</span>
</span></span><span class=line><span class=cl>git push
</span></span></code></pre></td></tr></table></div></div></li></ol><p><a href=https://awstip.com/terraform-variable-assignment-aa676dae25e3>Terraform variable assignment</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://www.xudongzhao.com/posts/ubuntu/><span class=title>« Prev</span><br><span>Ubuntu System Administration Cheatsheet</span>
</a><a class=next href=https://www.xudongzhao.com/posts/git-cheatsheet/><span class=title>Next »</span><br><span>Git and GitHub CLI Cheatsheet</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Terraform Infrastructure as Code Cheatsheet on x" href="https://x.com/intent/tweet/?text=Terraform%20Infrastructure%20as%20Code%20Cheatsheet&amp;url=https%3a%2f%2fwww.xudongzhao.com%2fposts%2fterraform%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Terraform Infrastructure as Code Cheatsheet on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.xudongzhao.com%2fposts%2fterraform%2f&amp;title=Terraform%20Infrastructure%20as%20Code%20Cheatsheet&amp;summary=Terraform%20Infrastructure%20as%20Code%20Cheatsheet&amp;source=https%3a%2f%2fwww.xudongzhao.com%2fposts%2fterraform%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Terraform Infrastructure as Code Cheatsheet on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.xudongzhao.com%2fposts%2fterraform%2f&title=Terraform%20Infrastructure%20as%20Code%20Cheatsheet"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Terraform Infrastructure as Code Cheatsheet on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.xudongzhao.com%2fposts%2fterraform%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Terraform Infrastructure as Code Cheatsheet on whatsapp" href="https://api.whatsapp.com/send?text=Terraform%20Infrastructure%20as%20Code%20Cheatsheet%20-%20https%3a%2f%2fwww.xudongzhao.com%2fposts%2fterraform%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Terraform Infrastructure as Code Cheatsheet on telegram" href="https://telegram.me/share/url?text=Terraform%20Infrastructure%20as%20Code%20Cheatsheet&amp;url=https%3a%2f%2fwww.xudongzhao.com%2fposts%2fterraform%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Terraform Infrastructure as Code Cheatsheet on ycombinator" href="https://news.ycombinator.com/submitlink?t=Terraform%20Infrastructure%20as%20Code%20Cheatsheet&u=https%3a%2f%2fwww.xudongzhao.com%2fposts%2fterraform%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.xudongzhao.com/>Xudong's Tech Notes</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>